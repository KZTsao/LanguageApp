<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>LanguageApp 測試頁</title>
</head>
<body>
  <h1>LanguageApp 測試頁</h1>

  <label>
    模式：
    <select id="mode">
      <option value="word">單字模式</option>
      <option value="sentence">句子模式</option>
    </select>
  </label>

  <div style="margin-top: 8px;">
    <textarea id="text" rows="3" cols="40" placeholder="在這裡輸入文字"></textarea>
  </div>

  <button id="sendBtn">送出分析</button>

  <pre id="result" style="margin-top: 16px; white-space: pre-wrap;"></pre>

  <script>
    const modeEl = document.getElementById('mode');
    const textEl = document.getElementById('text');
    const resultEl = document.getElementById('result');
    const btn = document.getElementById('sendBtn');

    btn.addEventListener('click', async () => {
      const mode = modeEl.value;
      const text = textEl.value.trim();
      if (!text) {
        alert('請輸入文字');
        return;
      }

      resultEl.textContent = '分析中…';

      try {
        const res = await fetch('/api/analyze', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ mode, text }),
        });

        const data = await res.json();

        if (!res.ok) {
          resultEl.textContent = '錯誤：' + (data.error || '未知錯誤');
          return;
        }

        resultEl.textContent = JSON.stringify(data, null, 2);
      } catch (err) {
        resultEl.textContent = '發生錯誤：' + err.message;
      }
    });
  </script>
</body>
</html>
